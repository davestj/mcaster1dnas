name: Mcaster1DNAS CI/CD - Development

on:
  push:
    branches:
      - development
  pull_request:
    branches:
      - development

env:
  # Build configuration
  BUILD_DIR: build
  INSTALL_PREFIX: /opt/mcaster1dnas

  # Test server configuration
  TEST_PORT: 8000
  TEST_ADMIN_USER: admin
  TEST_ADMIN_PASS: hackme

jobs:
  lint:
    name: Lint Checks
    runs-on: ubuntu-latest
    container:
      image: debian:12

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install lint tools
        run: |
          apt-get update
          apt-get install -y \
            libxml2-utils \
            yamllint

      - name: Lint XSL files
        run: |
          echo "=== Validating XSL files ==="
          find admin web -name "*.xsl" -type f | while read xsl; do
            echo "Checking: $xsl"
            xmllint --noout "$xsl" || exit 1
          done

      - name: Lint YAML configs
        run: |
          echo "=== Validating YAML configuration files ==="
          yamllint -d "{extends: default, rules: {line-length: {max: 120}, document-start: disable}}" \
            test-yaml-minimal.yaml \
            || echo "Warning: YAML style issues found (non-fatal)"

      - name: Check for common issues
        run: |
          echo "=== Checking for common coding issues ==="

          # Check for tabs in source files (should use spaces)
          if grep -r $'\t' src/*.c src/*.h 2>/dev/null | grep -v "Makefile"; then
            echo "Warning: Found tabs in C source files (prefer spaces)"
          fi

          # Check for trailing whitespace
          if find src -name "*.c" -o -name "*.h" | xargs grep -n " $" | head -5; then
            echo "Warning: Found trailing whitespace (non-fatal)"
          fi

  build-debian-12:
    name: Build on Debian 12
    runs-on: ubuntu-latest
    needs: lint
    container:
      image: debian:12

    outputs:
      version: ${{ steps.get_version.outputs.version }}
      full_version: ${{ steps.get_version.outputs.full_version }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Full history for git describe

      - name: Generate version
        id: get_version
        run: |
          # Make scripts executable
          chmod +x GIT-VERSION-GEN scripts/version-bump.sh

          # Generate version based on branch
          ./GIT-VERSION-GEN 2>&1 | tee version.log

          # Extract version
          BASE_VERSION=$(cat VERSION)
          FULL_VERSION=$(grep "GIT_VERSION=" version.log | cut -d= -f2)

          echo "Base version: $BASE_VERSION"
          echo "Full version: $FULL_VERSION"

          # Set outputs
          echo "version=$BASE_VERSION" >> $GITHUB_OUTPUT
          echo "full_version=$FULL_VERSION" >> $GITHUB_OUTPUT

          # Create version info file
          cat > build-version.txt <<EOF
          Build Information
          ==================
          Base Version: $BASE_VERSION
          Full Version: $FULL_VERSION
          Branch: $GITHUB_REF_NAME
          Commit: $GITHUB_SHA
          Build Date: $(date -u '+%Y-%m-%d %H:%M:%S UTC')
          Build Number: $GITHUB_RUN_NUMBER
          EOF

          cat build-version.txt

      - name: Install build dependencies
        run: |
          echo "=== Installing Debian 12 build dependencies ==="
          apt-get update
          apt-get install -y \
            build-essential \
            autoconf \
            automake \
            libtool \
            pkg-config \
            libxml2-dev \
            libxslt1-dev \
            libvorbis-dev \
            libtheora-dev \
            libspeex-dev \
            libcurl4-openssl-dev \
            libssl-dev \
            openssl \
            libyaml-dev \
            libogg-dev \
            libkate-dev \
            curl \
            vim \
            net-tools \
            procps

          echo "=== Dependency versions ==="
          autoconf --version | head -1
          automake --version | head -1
          libtool --version | head -1
          pkg-config --version
          curl --version | head -1

      - name: Run autoreconf
        run: |
          echo "=== Running autoreconf to generate configure script ==="
          autoreconf -fi
          ls -lh configure

      - name: Configure build
        run: |
          echo "=== Configuring Mcaster1DNAS build ==="
          ./configure \
            --prefix=${{ env.INSTALL_PREFIX }} \
            --with-yaml \
            --with-openssl \
            --sysconfdir=/etc

          echo ""
          echo "=== Configuration summary ==="
          grep -A 20 "Configuration:" config.log || true

      - name: Build Mcaster1DNAS
        run: |
          echo "=== Building Mcaster1DNAS ==="
          make -j$(nproc)

          echo ""
          echo "=== Build artifacts ==="
          ls -lh src/mcaster1
          file src/mcaster1

      - name: Run make install
        run: |
          echo "=== Installing Mcaster1DNAS ==="
          make install DESTDIR=$(pwd)/install-root

          echo ""
          echo "=== Installed files ==="
          find install-root -type f | head -20

          # Check that binary was installed
          if [ -f "install-root${{ env.INSTALL_PREFIX }}/bin/mcaster1" ]; then
            echo "✓ Binary installed successfully"
            ls -lh "install-root${{ env.INSTALL_PREFIX }}/bin/mcaster1"
          else
            echo "✗ Binary not found at expected location"
            exit 1
          fi

      - name: Create distribution tarball
        run: |
          echo "=== Creating distribution tarball ==="

          VERSION=$(cat VERSION)
          FULL_VERSION=$(grep "GIT_VERSION=" version.log | cut -d= -f2 || echo "$VERSION")
          TARBALL="mcaster1dnas-${FULL_VERSION}.tar.gz"

          echo "Creating tarball: $TARBALL"

          # Create tarball from install root
          cd install-root${{ env.INSTALL_PREFIX }}
          tar -czf "$GITHUB_WORKSPACE/$TARBALL" .

          cd $GITHUB_WORKSPACE
          ls -lh "$TARBALL"
          echo "✓ Tarball created: $TARBALL"

      - name: Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: mcaster1dnas-debian12-build
          path: |
            mcaster1dnas-*.tar.gz
            build-version.txt
            install-root${{ env.INSTALL_PREFIX }}/bin/mcaster1
            install-root${{ env.INSTALL_PREFIX }}/share/mcaster1dnas/
          retention-days: 7

  test-http:
    name: Test HTTP Server
    runs-on: ubuntu-latest
    needs: build-debian-12
    container:
      image: debian:12

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install runtime dependencies
        run: |
          apt-get update
          apt-get install -y \
            libxml2 \
            libxslt1.1 \
            libvorbis0a \
            libtheora0 \
            libspeex1 \
            libcurl4 \
            libssl3 \
            libyaml-0-2 \
            curl \
            jq

      - name: Download build artifacts
        uses: actions/download-artifact@v4
        with:
          name: mcaster1dnas-debian12-build

      - name: Display version info
        run: |
          echo "=== Build Version Information ==="
          cat build-version.txt || echo "Version info not available"

      - name: Extract and setup binary
        run: |
          echo "=== Extracting binary from artifact ==="

          # The artifact contains: install-root/opt/mcaster1dnas/...
          # We need to move it to the actual /opt location

          if [ -d "install-root${{ env.INSTALL_PREFIX }}" ]; then
            mkdir -p ${{ env.INSTALL_PREFIX }}
            cp -r install-root${{ env.INSTALL_PREFIX }}/* ${{ env.INSTALL_PREFIX }}/
            chmod +x ${{ env.INSTALL_PREFIX }}/bin/mcaster1
            echo "✓ Binary installed to ${{ env.INSTALL_PREFIX }}/bin/mcaster1"
            ls -lh ${{ env.INSTALL_PREFIX }}/bin/mcaster1
          else
            echo "✗ Binary not found in artifact"
            ls -R
            exit 1
          fi

      - name: Setup test environment
        run: |
          echo "=== Setting up test environment ==="

          # Create necessary directories
          mkdir -p /tmp/mcaster1-test/logs
          mkdir -p /tmp/mcaster1-test/web
          mkdir -p /tmp/mcaster1-test/admin

          # Copy web and admin files from source checkout
          if [ -d "web" ] && [ "$(ls -A web 2>/dev/null)" ]; then
            cp -r web/* /tmp/mcaster1-test/web/
            echo "✓ Copied web files"
          else
            echo "⚠ No web directory found in source"
          fi

          if [ -d "admin" ] && [ "$(ls -A admin 2>/dev/null)" ]; then
            cp -r admin/* /tmp/mcaster1-test/admin/
            echo "✓ Copied admin files"
          else
            echo "⚠ No admin directory found in source"
          fi

          # Create minimal test config
          cat > /tmp/mcaster1-test/test-ci.yaml <<EOF
          ---
          location: "CI Test Server"
          admin: "ci@test.local"
          hostname: "localhost"
          fileserve: true

          authentication:
            source-password: "testpass"
            admin-user: "${{ env.TEST_ADMIN_USER }}"
            admin-password: "${{ env.TEST_ADMIN_PASS }}"

          limits:
            clients: 10
            sources: 2
            workers: 1

          listen-sockets:
            - port: ${{ env.TEST_PORT }}
              bind-address: "127.0.0.1"

          paths:
            basedir: "/tmp/mcaster1-test"
            logdir: "/tmp/mcaster1-test/logs"
            webroot: "/tmp/mcaster1-test/web"
            adminroot: "/tmp/mcaster1-test/admin"

          logging:
            errorlog:
              name: "error.log"
              level: "debug"
            accesslog:
              name: "access.log"
          EOF

          echo "✓ Test environment ready"
          cat /tmp/mcaster1-test/test-ci.yaml

      - name: Create non-root user for server
        run: |
          echo "=== Creating non-root user for Mcaster1DNAS ==="

          # Create mcaster1 user if it doesn't exist
          if ! id -u mcaster1 >/dev/null 2>&1; then
            useradd -r -s /bin/false mcaster1
            echo "✓ Created user: mcaster1"
          fi

          # Set ownership of test directories
          chown -R mcaster1:mcaster1 /tmp/mcaster1-test
          chown -R mcaster1:mcaster1 ${{ env.INSTALL_PREFIX }}

          echo "✓ Permissions set for mcaster1 user"

      - name: Start Mcaster1DNAS server
        run: |
          echo "=== Starting Mcaster1DNAS server ==="

          # Verify binary exists and is executable
          if [ ! -x "${{ env.INSTALL_PREFIX }}/bin/mcaster1" ]; then
            echo "✗ Binary not found or not executable"
            ls -lh ${{ env.INSTALL_PREFIX }}/bin/ || true
            exit 1
          fi

          # Verify config exists
          if [ ! -f "/tmp/mcaster1-test/test-ci.yaml" ]; then
            echo "✗ Config file not found"
            exit 1
          fi

          echo "Starting server with config:"
          echo "Binary: ${{ env.INSTALL_PREFIX }}/bin/mcaster1"
          echo "Config: /tmp/mcaster1-test/test-ci.yaml"
          echo "Port: ${{ env.TEST_PORT }}"
          echo "User: mcaster1"

          # Create a startup script that runs as mcaster1 user
          cat > /tmp/start-server.sh << 'SCRIPT_EOF'
#!/bin/sh
exec /opt/mcaster1dnas/bin/mcaster1 -c /tmp/mcaster1-test/test-ci.yaml
SCRIPT_EOF

          chmod +x /tmp/start-server.sh
          chown mcaster1:mcaster1 /tmp/start-server.sh

          # Start server as non-root user in background
          su -s /bin/sh mcaster1 -c "/tmp/start-server.sh > /tmp/mcaster1-stdout.log 2>&1 &"

          # Give it a moment to start
          sleep 3

          # Find the actual mcaster1 process PID
          SERVER_PID=$(pgrep -u mcaster1 mcaster1 || echo "")
          if [ -n "$SERVER_PID" ]; then
            echo "Server PID: $SERVER_PID"
            echo $SERVER_PID > /tmp/server.pid
          else
            echo "✗ Could not find server process"
            echo "=== Process list ==="
            ps aux | grep mcaster1 | grep -v grep || echo "No mcaster1 processes"
            echo "=== Startup script output ==="
            cat /tmp/mcaster1-stdout.log || true
            exit 1
          fi

          # Wait a moment for initial startup
          sleep 2

          # Check if process is still running
          if ! kill -0 $SERVER_PID 2>/dev/null; then
            echo "✗ Server process died immediately after start"
            echo "=== Server stdout/stderr ==="
            cat /tmp/mcaster1-stdout.log || true
            echo "=== Error log ==="
            cat /tmp/mcaster1-test/logs/error.log || true
            exit 1
          fi

          # Wait for server to be ready
          echo "Waiting for server to accept connections..."
          for i in {1..30}; do
            if curl -s http://localhost:${{ env.TEST_PORT }}/ > /dev/null 2>&1; then
              echo "✓ Server started successfully after ${i} seconds"
              echo "Server is running with PID: $SERVER_PID"
              break
            fi

            # Check if process died
            if ! kill -0 $SERVER_PID 2>/dev/null; then
              echo "✗ Server process died during startup"
              echo "=== Server stdout/stderr ==="
              cat /tmp/mcaster1-stdout.log || true
              echo "=== Error log ==="
              cat /tmp/mcaster1-test/logs/error.log || true
              exit 1
            fi

            if [ $i -eq 30 ]; then
              echo "✗ Server failed to accept connections within 30 seconds"
              echo "Server process is running but not responding"
              echo "=== Server stdout/stderr ==="
              cat /tmp/mcaster1-stdout.log || true
              echo "=== Error log ==="
              cat /tmp/mcaster1-test/logs/error.log || true
              exit 1
            fi
            sleep 1
          done

          # Final health check
          sleep 1
          if ! kill -0 $SERVER_PID 2>/dev/null; then
            echo "✗ Server died after initial startup"
            cat /tmp/mcaster1-stdout.log || true
            cat /tmp/mcaster1-test/logs/error.log || true
            exit 1
          fi

          echo "✓ Server is healthy and ready for tests"

      - name: Verify server is running
        run: |
          echo "=== Verifying server status before tests ==="

          # Check if PID file exists
          if [ -f /tmp/server.pid ]; then
            SERVER_PID=$(cat /tmp/server.pid)
            echo "Server PID from file: $SERVER_PID"

            # Check if process is running
            if ps -p $SERVER_PID > /dev/null 2>&1; then
              echo "✓ Server process is running (PID: $SERVER_PID)"
              ps aux | grep mcaster1 | grep -v grep
            else
              echo "✗ Server process is NOT running (PID: $SERVER_PID)"
              echo "=== Process list ==="
              ps aux | grep mcaster1 | grep -v grep || echo "No mcaster1 processes found"
            fi
          else
            echo "✗ No PID file found at /tmp/server.pid"
          fi

          # Check if port is listening
          echo ""
          echo "=== Checking port 8000 ==="
          netstat -tlnp 2>/dev/null | grep 8000 || echo "Port 8000 not listening"

          # Show recent server output
          echo ""
          echo "=== Server stdout/stderr (last 50 lines) ==="
          tail -50 /tmp/mcaster1-stdout.log 2>/dev/null || echo "No stdout log found"

          # Show error log
          echo ""
          echo "=== Server error log (last 20 lines) ==="
          tail -20 /tmp/mcaster1-test/logs/error.log 2>/dev/null || echo "No error log found"

      - name: Test HTTP endpoints
        run: |
          echo "=== Testing HTTP endpoints ==="

          # Test root endpoint (should redirect to status.xsl)
          echo "Test 1: Root endpoint"
          if curl -f -s -o /tmp/root.html http://localhost:${{ env.TEST_PORT }}/; then
            echo "✓ Root endpoint accessible"
          else
            echo "✗ Root endpoint failed"
            exit 1
          fi

          # Test status.xsl
          echo "Test 2: Public status page"
          if curl -f -s -o /tmp/status.html http://localhost:${{ env.TEST_PORT }}/status.xsl; then
            echo "✓ status.xsl accessible"
            grep -q "Mcaster1DNAS" /tmp/status.html && echo "  ✓ Contains Mcaster1DNAS branding"
          else
            echo "✗ status.xsl failed"
            exit 1
          fi

          # Test JSON API
          echo "Test 3: JSON API endpoint"
          if curl -f -s -o /tmp/status.json http://localhost:${{ env.TEST_PORT }}/status-json.xsl; then
            echo "✓ status-json.xsl accessible"
            cat /tmp/status.json | jq '.' > /dev/null && echo "  ✓ Valid JSON"
            cat /tmp/status.json | jq -r '.icestats.admin' && echo "  ✓ Admin field present"
          else
            echo "✗ JSON API failed"
            exit 1
          fi

      - name: Test admin authentication
        run: |
          echo "=== Testing admin authentication ==="

          # Test admin without auth (should fail)
          echo "Test 1: Admin without credentials (should fail)"
          if curl -f -s http://localhost:${{ env.TEST_PORT }}/admin/stats.xsl > /dev/null 2>&1; then
            echo "✗ Admin accessible without auth (security issue!)"
            exit 1
          else
            echo "✓ Admin properly requires authentication"
          fi

          # Test admin with wrong credentials (should fail)
          echo "Test 2: Admin with wrong credentials (should fail)"
          if curl -f -s -u wronguser:wrongpass http://localhost:${{ env.TEST_PORT }}/admin/stats.xsl > /dev/null 2>&1; then
            echo "✗ Admin accepted wrong credentials (security issue!)"
            exit 1
          else
            echo "✓ Admin properly rejects wrong credentials"
          fi

          # Test admin with correct credentials (should succeed)
          echo "Test 3: Admin with correct credentials"
          if curl -f -s -u ${{ env.TEST_ADMIN_USER }}:${{ env.TEST_ADMIN_PASS }} \
              -o /tmp/admin-stats.html \
              http://localhost:${{ env.TEST_PORT }}/admin/stats.xsl; then
            echo "✓ Admin login successful"
            grep -q "Server Information" /tmp/admin-stats.html && echo "  ✓ Admin page rendered correctly"
          else
            echo "✗ Admin login failed with correct credentials"
            exit 1
          fi

          # Test various admin pages
          echo "Test 4: Admin page accessibility"
          for page in stats.xsl listmounts.xsl status.xsl; do
            if curl -f -s -u ${{ env.TEST_ADMIN_USER }}:${{ env.TEST_ADMIN_PASS }} \
                http://localhost:${{ env.TEST_PORT }}/admin/$page > /dev/null; then
              echo "  ✓ /admin/$page accessible"
            else
              echo "  ✗ /admin/$page failed"
              exit 1
            fi
          done

      - name: Test ICY metadata endpoints
        run: |
          echo "=== Testing ICY metadata endpoints ==="

          # Note: Without an active source, we can't test full ICY2 metadata
          # But we can test that the server accepts ICY headers

          echo "Test 1: ICY metadata request header support"
          response=$(curl -s -H "Icy-MetaData: 1" http://localhost:${{ env.TEST_PORT }}/status.xsl)
          if [ -n "$response" ]; then
            echo "✓ Server accepts ICY headers"
          fi

          echo "Test 2: Check for ICY2 support in server info"
          if curl -s -u ${{ env.TEST_ADMIN_USER }}:${{ env.TEST_ADMIN_PASS }} \
              http://localhost:${{ env.TEST_PORT }}/admin/stats.xsl | grep -i "mcaster1" > /dev/null; then
            echo "✓ Server identifies as Mcaster1DNAS"
          fi

      - name: Check server logs
        if: always()
        run: |
          echo "=== Server Error Log ==="
          cat /tmp/mcaster1-test/logs/error.log || echo "No error log found"

          echo ""
          echo "=== Server Access Log ==="
          cat /tmp/mcaster1-test/logs/access.log || echo "No access log found"

      - name: Stop server
        if: always()
        run: |
          if [ -f /tmp/server.pid ]; then
            kill $(cat /tmp/server.pid) || true
            sleep 2
            echo "✓ Server stopped"
          fi

      - name: Upload test logs
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-logs
          path: /tmp/mcaster1-test/logs/
          retention-days: 7

  test-yaml-config:
    name: Test YAML Configuration
    runs-on: ubuntu-latest
    needs: build-debian-12
    container:
      image: debian:12

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install runtime dependencies
        run: |
          apt-get update
          apt-get install -y \
            libxml2 \
            libxslt1.1 \
            libvorbis0a \
            libcurl4 \
            libssl3 \
            libyaml-0-2

      - name: Download build artifacts
        uses: actions/download-artifact@v4
        with:
          name: mcaster1dnas-debian12-build

      - name: Extract and setup binary
        run: |
          echo "=== Extracting binary from artifact ==="

          # The artifact contains: install-root/opt/mcaster1dnas/...
          if [ -d "install-root${{ env.INSTALL_PREFIX }}" ]; then
            mkdir -p ${{ env.INSTALL_PREFIX }}
            cp -r install-root${{ env.INSTALL_PREFIX }}/* ${{ env.INSTALL_PREFIX }}/
            chmod +x ${{ env.INSTALL_PREFIX }}/bin/mcaster1
            echo "✓ Binary installed"
          else
            echo "✗ Binary not found in artifact"
            exit 1
          fi

      - name: Test YAML config loading
        run: |
          echo "=== Testing YAML configuration parsing ==="

          # Create test directories
          mkdir -p /tmp/yaml-test/logs
          mkdir -p /tmp/yaml-test/web
          mkdir -p /tmp/yaml-test/admin

          # Copy web and admin files from source checkout
          if [ -d "web" ] && [ "$(ls -A web 2>/dev/null)" ]; then
            cp -r web/* /tmp/yaml-test/web/
          fi
          if [ -d "admin" ] && [ "$(ls -A admin 2>/dev/null)" ]; then
            cp -r admin/* /tmp/yaml-test/admin/
          fi

          # Test minimal YAML config
          cat > /tmp/yaml-test.yaml <<EOF
          ---
          location: "YAML Test"
          admin: "test@test.local"
          hostname: "localhost"

          authentication:
            source-password: "test"
            admin-user: "admin"
            admin-password: "test"

          limits:
            clients: 5
            sources: 1

          listen-sockets:
            - port: 8001

          paths:
            basedir: "/tmp/yaml-test"
            logdir: "/tmp/yaml-test/logs"
            webroot: "/tmp/yaml-test/web"
            adminroot: "/tmp/yaml-test/admin"

          logging:
            errorlog:
              name: "error.log"
              level: "info"
          EOF

          # Try to start with YAML config (will fail to bind port, but should parse config)
          echo "Starting server to test config parsing..."
          timeout 5 ${{ env.INSTALL_PREFIX }}/bin/mcaster1 -c /tmp/yaml-test.yaml 2>&1 | tee /tmp/startup.log || true

          # Check that config was parsed (no YAML parsing errors)
          if grep -i "yaml" /tmp/startup.log | grep -i "error\|failed" > /dev/null; then
            echo "✗ YAML parsing errors detected"
            cat /tmp/startup.log
            exit 1
          else
            echo "✓ YAML configuration parsed successfully"
          fi

  security-check:
    name: Security Checks
    runs-on: ubuntu-latest
    needs: lint

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Check for hardcoded credentials
        run: |
          echo "=== Checking for hardcoded credentials (excluding test files) ==="

          # Look for potential hardcoded passwords in source files
          if grep -r -i "password.*=.*\"" src/ | grep -v "strcmp\|strncmp\|admin_password\|source_password"; then
            echo "Warning: Potential hardcoded credentials found"
          else
            echo "✓ No obvious hardcoded credentials in source"
          fi

      - name: Check for insecure functions
        run: |
          echo "=== Checking for insecure C functions ==="

          insecure_funcs="strcpy strcat sprintf gets"
          found_issues=0

          for func in $insecure_funcs; do
            if grep -r "\b$func\b" src/*.c 2>/dev/null | grep -v "//.*$func"; then
              echo "Warning: Found potentially insecure function: $func"
              found_issues=$((found_issues + 1))
            fi
          done

          if [ $found_issues -eq 0 ]; then
            echo "✓ No obvious insecure functions found"
          else
            echo "⚠ Found $found_issues potentially insecure function(s) - review recommended"
          fi

  summary:
    name: Build Summary
    runs-on: ubuntu-latest
    needs: [lint, build-debian-12, test-http, test-yaml-config, security-check]
    if: always()

    steps:
      - name: Check build status
        run: |
          echo "=== Mcaster1DNAS CI/CD Build Summary ==="
          echo ""
          echo "Branch: development"
          echo "Commit: ${{ github.sha }}"
          echo "Build Date: $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
          echo ""
          echo "All checks completed successfully! ✓"
