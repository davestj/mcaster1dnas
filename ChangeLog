Mcaster1DNAS ChangeLog
================================================================================

Version 2.6.0 - February 15, 2026
--------------------------------------------------------------------------------

MAJOR FEATURES:

* ICY-META v2.1+ Protocol Support
  - Complete implementation of ICY-META v2.1+ extended metadata protocol
  - Automatic protocol detection via icy-metadata-version header
  - Seamless failover to legacy ICY 1.x when version header absent
  - NO configuration changes required - works automatically
  - Supports 29+ metadata fields across 6 categories:
    * Core: station-id, name, url, genre, bitrate, public
    * Podcast: host, rss, episode, duration, language
    * Video: type, link, title, platform, resolution
    * Social Media: dj-handle, twitter, instagram, tiktok, emoji, hashtags
    * Access Control: nsfw, ai-generated, geo-region, auth-token
    * Verification: certificate-verify, verification-status
  - Pure HTTP header communication (encoder to server)
  - All metadata accessible via stats.xml for admin interface
  - Tested with curl, ready for Mcaster1Encoder integration
  - See ICY2_PROTOCOL_SPEC.md for complete specification

* HTTPS Source Encoder Support
  - SSL/TLS auto-detection on any port
  - Encoders can send streams via HTTPS for enhanced security
  - Works with both ICY 1.x and ICY2 protocols
  - Automatic protocol detection without port restrictions
  - Compatible with: FFmpeg, Liquidsoap, Butt (v0.1.30+), OBS plugins
  - No configuration changes needed - auto-detects SSL handshake

PROTOCOL IMPROVEMENTS:

* New ICY2 Metadata Module (icy2_meta.c/h)
  - Dedicated parsing engine for ICY2 headers
  - Modular design for easy maintenance and extension
  - Clean integration with existing stats system
  - Memory-efficient structure (calloc-based allocation)
  - Comprehensive logging for debugging
  - Forward-compatible with future ICY 2.2, 2.3 versions

* Source Handler Enhancements (source.c)
  - ICY2 detection before legacy ICY 1.x parsing
  - Automatic protocol negotiation
  - Backward compatible with all existing encoders
  - Enhanced logging for protocol detection

BUILD SYSTEM:

* ICY2 Module Integration
  - Added icy2_meta.c and icy2_meta.h to build system
  - Automatic compilation with all builds (no configure flag needed)
  - Zero external dependencies (uses existing httpp parser)

DOCUMENTATION:

* New Documentation Files
  - ICY2_PROTOCOL_SPEC.md - Complete ICY-META v2.1+ specification
  - ICY2_SIMPLIFIED_PLAN.md - Implementation plan and architecture
  - Updated README.md with ICY2 features and protocol link
  - Updated TODO.md with future ICY2 enhancements

* Enhanced Documentation
  - curl testing examples for ICY2 protocol
  - Client implementation guidelines
  - Server integration documentation
  - Future protocol version roadmap (2.2, 2.3)

TESTING & VALIDATION:

* ICY2 Protocol Testing
  - Verified auto-detection of icy-metadata-version header
  - Confirmed parsing of all 29+ metadata fields
  - Tested failover to ICY 1.x for non-ICY2 clients
  - Validated stats.xml integration
  - curl-based testing framework established

* HTTPS Encoder Testing
  - Confirmed SSL auto-detection on HTTPS port (9443)
  - Tested with curl HTTPS PUT requests
  - Verified certificate handling
  - Validated source authentication over HTTPS

COMPATIBILITY:

* Backward Compatibility
  - 100% compatible with existing ICY 1.x encoders
  - Legacy icy-name, icy-genre, icy-url headers still work
  - No breaking changes to existing functionality
  - Clients without icy-metadata-version use ICY 1.x automatically

* Forward Compatibility
  - Version detection supports ICY 2.x (2.0, 2.1, 2.2, etc.)
  - Extensible metadata structure for future fields
  - Protocol versioning allows graceful upgrades

DEPENDENCIES:

* No new dependencies for ICY2 support
  - Uses existing libxml2 for stats output
  - Uses existing httpp for header parsing
  - Pure C implementation, no external libraries

KNOWN ISSUES:

* SSH Key Authentication for ICY2
  - Planned for v2.6.1 (not implemented in v2.6.0)
  - Will support public/private key pairs for HTTPS connections
  - Framework designed, implementation deferred

================================================================================

Version 2.5.0 - February 14, 2026
--------------------------------------------------------------------------------

MAJOR FEATURES:

* YAML Configuration Support
  - Full YAML configuration file support alongside existing XML
  - Automatic format detection (XML vs YAML)
  - Complete feature parity with XML configuration
  - 100% of Icecast-KH features supported in YAML format
  - Four comprehensive YAML templates provided:
    * mcaster1.yaml.in - Full-featured template with 12 mount examples
    * mcaster1_minimal.yaml.in - Minimal configuration
    * mcaster1_shoutcast_compat.yaml.in - Shoutcast DSP compatibility
    * mcaster1_advanced.yaml.in - All advanced features demonstrated
  - See YAML_IMPLEMENTATION.md for complete documentation

* YP Connection Logging
  - Per-YP-server logging capability for debugging directory issues
  - Optional yp-logfile parameter in directory configuration
  - Logs all YP transactions: add, remove, touch operations
  - Timestamped entries with success/failure status
  - Separate log file for each YP directory server
  - Available in both XML and YAML configurations
  - See YP_LOGGING_FEATURE.md for implementation details

ADMIN INTERFACE IMPROVEMENTS:

* Tabbed Logs Interface (admin/logs.xsl)
  - Redesigned logs page with modern tabbed navigation
  - Four tabs: Access Log, Error Log, Playlist Log, YP Connections
  - Clean design with smooth transitions
  - Session persistence (remembers active tab)
  - Helpful descriptions for each log type
  - YP Connections tab shows YP transaction logs

* Fixed Admin Pages
  - Fixed XML parsing errors in listmounts.xsl, managerelays.xsl, logs.xsl
  - Added missing live clock display to all admin pages
  - Corrected tag structure and formatting issues

BUILD SYSTEM:

* YAML Build Support
  - Added --with-yaml configure option
  - Conditional compilation based on libyaml availability
  - PKG_CHECK_MODULES for yaml-0.1 library detection
  - Graceful fallback if YAML support not compiled in

CONFIGURATION PARSERS:

* XML Parser (cfgfile.c)
  - Added support for <yp-logfile> element in <directory> blocks
  - Proper memory management for YP log file paths

* YAML Parser (cfgfile_yaml.c)
  - Complete YAML parser implementation (~2000 lines)
  - Supports all configuration elements:
    - Server settings (location, admin, hostname, limits, etc.)
    - Listen sockets (HTTP, HTTPS, IPv6, Shoutcast compatibility)
    - Mount points with all authentication methods
    - Relays with multi-host failover
    - YP directories with optional logging
    - Master/slave replication
    - Paths, security, and logging options
  - Full error reporting with line numbers
  - Type validation and default values

DEPENDENCIES:

* Added libyaml >= 0.1.7 (optional)
  - Debian/Ubuntu: apt-get install libyaml-dev
  - RHEL/CentOS: yum install libyaml-devel

DOCUMENTATION:

* New Documentation Files
  - YAML_IMPLEMENTATION.md - Complete YAML usage guide
  - YP_LOGGING_FEATURE.md - YP logging implementation details
  - YAML_TEST_REPORT.txt - Production testing verification

* Updated Configuration Templates
  - All XML templates updated with yp-logfile examples
  - All YAML templates include comprehensive feature demonstrations

EXAMPLES:

* YAML Configuration Examples Added
  - Multiple mount points (12 different configurations)
  - Authentication methods (htpasswd, URL-based, command)
  - Relay configurations with failover
  - Multi-port setups (8 ports demonstrated)
  - Admin users and security settings
  - YP directory configurations with logging
  - Master/slave replication
  - Custom HTTP headers
  - Bandwidth limiting and burst control

TESTING:

* Production Validation
  - Server tested on 15.204.91.208:9330/9443
  - YAML configuration auto-detection verified
  - All admin pages tested and working
  - No memory leaks detected
  - Performance identical to XML configuration

BACKWARD COMPATIBILITY:

* 100% backward compatible
  - All existing XML configurations continue to work
  - No breaking changes to existing features
  - Optional features only activate when configured

KNOWN ISSUES:

* None reported

================================================================================
For previous version history, see git commit logs.
