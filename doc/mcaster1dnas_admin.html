<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Interface - Mcaster1DNAS Documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
    <style>
        :root{--mcaster-blue:#0ea5e9;--dnas-green:#22c55e;--text-primary:#1f2937;--text-secondary:#6b7280;--bg-white:#fff;--bg-light:#f8fafc;--bg-accent:#f1f5f9;--border-light:#e2e8f0;--shadow-medium:0 4px 6px -1px rgb(0 0 0 / 0.1);--gradient-brand:linear-gradient(135deg, var(--mcaster-blue), var(--dnas-green));--radius-md:0.5rem;--radius-lg:0.75rem;--font-sans:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;--font-mono:'SF Mono', 'Monaco', 'Menlo', 'Ubuntu Mono', monospace}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:var(--font-sans);line-height:1.6;color:var(--text-primary);background:var(--bg-light)}
        .breadcrumb{background:var(--bg-white);padding:1rem 0;border-bottom:1px solid var(--border-light)}
        .breadcrumb-container{max-width:1200px;margin:0 auto;padding:0 1rem;display:flex;align-items:center;gap:0.5rem;color:var(--text-secondary);font-size:0.875rem}
        .breadcrumb a{color:var(--mcaster-blue);text-decoration:none}
        .hero{background:var(--gradient-brand);color:white;padding:4rem 0 2rem 0}
        .hero-content{max-width:1200px;margin:0 auto;padding:0 1rem}
        .hero h1{font-size:3rem;font-weight:800;margin-bottom:0.5rem}
        .hero p{font-size:1.25rem;opacity:0.95}
        .container{max-width:1200px;margin:0 auto;padding:3rem 1rem}
        .content-card{background:var(--bg-white);border-radius:var(--radius-lg);padding:3rem;box-shadow:var(--shadow-medium);margin-bottom:2rem}
        .content-card h2{font-size:2rem;font-weight:700;color:var(--text-primary);margin:2.5rem 0 1rem 0;display:flex;align-items:center;gap:0.75rem}
        .content-card h2:first-child{margin-top:0}
        .content-card h2 i{color:var(--mcaster-blue)}
        .content-card h3{font-size:1.5rem;font-weight:600;color:var(--text-primary);margin:2rem 0 1rem 0}
        .content-card p{font-size:1.125rem;color:var(--text-secondary);line-height:1.8;margin-bottom:1.5rem}
        .content-card ul{margin:1rem 0 1.5rem 2rem}
        .content-card li{color:var(--text-secondary);line-height:1.8;margin-bottom:0.75rem}
        .code-block{background:#1e293b;color:#e2e8f0;padding:1.5rem;border-radius:var(--radius-md);overflow-x:auto;margin:1.5rem 0;font-family:var(--font-mono);font-size:0.875rem;line-height:1.6}
        .admin-function{background:var(--bg-light);border-left:4px solid var(--mcaster-blue);padding:1.5rem;border-radius:var(--radius-lg);margin-bottom:1.5rem}
        .admin-function h4{font-size:1.25rem;font-weight:600;color:var(--text-primary);margin-bottom:1rem}
        .alert-box{padding:1.5rem;border-radius:var(--radius-md);margin:1.5rem 0;display:flex;align-items:flex-start;gap:1rem;background:#dbeafe;border:1px solid #3b82f6}
        .alert-icon{font-size:1.25rem;color:#1e40af}
        .alert-content{color:#1e3a8a}
        @media (max-width:768px){.hero h1{font-size:2rem}.content-card{padding:2rem 1.5rem}}
    </style>
</head>
<body>
    <div class="breadcrumb">
        <div class="breadcrumb-container">
            <a href="index.html"><i class="fas fa-home"></i> Documentation</a>
            <i class="fas fa-chevron-right"></i>
            <span>Admin Interface</span>
        </div>
    </div>

    <div class="hero">
        <div class="hero-content">
            <h1><i class="fas fa-user-shield"></i> Admin Interface</h1>
            <p>Master the web-based administration interface</p>
        </div>
    </div>

    <div class="container">
        <div class="content-card">
            <h2><i class="fas fa-info-circle"></i> Overview</h2>
            <p>
                The Mcaster1DNAS admin interface provides comprehensive control over your streaming server through a web-based interface.
                From managing listeners and sources to updating metadata and monitoring statistics, the admin interface gives you complete
                control over every aspect of your server.
            </p>

            <div class="alert-box">
                <i class="fas fa-lock alert-icon"></i>
                <div class="alert-content">
                    <strong>Authentication Required:</strong> All admin functions require HTTP authentication. Use the admin username
                    and password from your configuration file. Mount-specific functions can use either admin credentials or
                    mount-specific credentials if configured.
                </div>
            </div>

            <h2><i class="fas fa-mountain"></i> Mount-Specific Admin Functions</h2>
            <p>
                These functions apply to specific mountpoints. Access them by specifying the mountpoint in the URL.
                The examples use <code>192.168.1.10:8000</code> as the server address.
            </p>

            <div class="admin-function">
                <h4><i class="fas fa-tags"></i> Metadata Update</h4>
                <p>Update the metadata (song information) for a mountpoint. Supports all audio formats with ICY-META v2.1+ protocol enhancements in Mcaster1DNAS v2.5.1-rc1.</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/metadata?mount=/stream&mode=updinfo&song=Artist+-+Title</pre></div>
                <p><strong>Parameters:</strong></p>
                <ul>
                    <li><code>mount</code> - The mountpoint to update (e.g., /stream, /live.ogg)</li>
                    <li><code>mode</code> - Update mode (updinfo for song updates)</li>
                    <li><code>song</code> - Song information (URL-encoded, use + for spaces)</li>
                </ul>
            </div>

            <div class="admin-function">
                <h4><i class="fas fa-rotate"></i> Fallback Update</h4>
                <p>Configure or update the fallback mountpoint for automatic listener transfer when a source disconnects.</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/fallbacks?mount=/stream.ogg&fallback=/backup.ogg</pre></div>
                <p><strong>Use Case:</strong> Prevent dead air by automatically moving listeners to a backup stream when the main source disconnects.</p>
            </div>

            <div class="admin-function">
                <h4><i class="fas fa-users"></i> List Clients</h4>
                <p>Display all listeners currently connected to a specific mountpoint. Returns detailed XML data including IP addresses, connection times, and user agents.</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/listclients?mount=/stream</pre></div>
            </div>

            <div class="admin-function">
                <h4><i class="fas fa-user-times"></i> Kill Client</h4>
                <p>Disconnect a specific listener from a mountpoint. Useful for managing problem connections or enforcing listener limits.</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/killclient?mount=/stream&id=12345</pre></div>
                <p><strong>Note:</strong> Get the client ID from the listclients output.</p>
            </div>

            <div class="admin-function">
                <h4><i class="fas fa-people-arrows"></i> Move Clients</h4>
                <p>Transfer all listeners from one mountpoint to another without disconnection.</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/moveclients?mount=/old&destination=/new</pre></div>
                <p><strong>Use Case:</strong> Switch between different quality streams or migrate listeners during server maintenance.</p>
            </div>

            <div class="admin-function">
                <h4><i class="fas fa-plug"></i> Kill Source</h4>
                <p>Disconnect a source client from a mountpoint.</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/killsource?mount=/stream</pre></div>
                <p><strong>Warning:</strong> This will terminate the source connection immediately. All listeners will be moved to the fallback mountpoint if configured.</p>
            </div>

            <h2><i class="fas fa-server"></i> Server-Wide Admin Functions</h2>
            <p>These functions affect the entire server and require admin credentials (not mount-specific credentials).</p>

            <div class="admin-function">
                <h4><i class="fas fa-chart-bar"></i> Server Statistics</h4>
                <p>Retrieve comprehensive server statistics in XML format.</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/stats.xml</pre></div>
                <p>Includes connection counts, source information, listener counts, and mountpoint details. See <a href="mcaster1dnas_stats.html" style="color:var(--mcaster-blue)">Server Statistics</a> for details.</p>
            </div>

            <div class="admin-function">
                <h4><i class="fas fa-list"></i> List Mounts</h4>
                <p>Display all currently active mountpoints with their statistics.</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/listmounts</pre></div>
            </div>

            <div class="admin-function">
                <h4><i class="fas fa-sync"></i> Reload Configuration</h4>
                <p>Reload the YAML configuration file without restarting the server (v2.5.1-rc1 feature).</p>
                <div class="code-block"><pre>http://192.168.1.10:8000/admin/reloadconfig</pre></div>
                <p><strong>Note:</strong> Some settings require a full server restart. Configuration errors will be logged.</p>
            </div>

            <h2><i class="fas fa-desktop"></i> Web-Based Admin Interface</h2>
            <p>
                Mcaster1DNAS includes a web-based admin interface built with XSLT transformations. Access it at:
            </p>
            <div class="code-block"><pre>http://yourserver:8000/admin/stats.xsl</pre></div>

            <h3>Features of the Web Interface</h3>
            <ul>
                <li><strong>Real-time Statistics:</strong> Live server and mountpoint statistics</li>
                <li><strong>Listener Management:</strong> View and disconnect individual listeners</li>
                <li><strong>Source Management:</strong> Monitor and control source connections</li>
                <li><strong>Authentication Management:</strong> Manage listener authentication (htpasswd users)</li>
                <li><strong>Metadata Updates:</strong> Update song information through web forms</li>
                <li><strong>Custom Styling:</strong> Modify XSLT files in the admin/ directory to customize appearance</li>
            </ul>

            <h2><i class="fas fa-code"></i> Programmatic Access</h2>
            <p>
                The admin interface can be accessed programmatically using HTTP requests. This enables:
            </p>
            <ul>
                <li>Automated metadata updates from playout systems</li>
                <li>Custom monitoring and alerting scripts</li>
                <li>Integration with broadcasting automation software</li>
                <li>RESTful API development using the XML endpoints</li>
                <li>Custom dashboards and status pages</li>
            </ul>

            <h3>Example: Automated Metadata Update</h3>
            <div class="code-block"><pre>#!/bin/bash
SONG="$(nowplaying-script)"
curl -u admin:password \
  "http://localhost:8000/admin/metadata?mount=/stream&mode=updinfo&song=${SONG}"</pre></div>

            <h2><i class="fas fa-shield-alt"></i> Security Considerations</h2>
            <ul>
                <li><strong>HTTPS Recommended:</strong> Use SSL/TLS for admin interface access in production</li>
                <li><strong>Strong Passwords:</strong> Use complex passwords for admin accounts</li>
                <li><strong>IP Restrictions:</strong> Consider firewall rules to limit admin access</li>
                <li><strong>Audit Logs:</strong> Monitor access.log for admin activity</li>
                <li><strong>Mount Passwords:</strong> Use different passwords for each mountpoint</li>
            </ul>

            <div style="background:var(--bg-accent);border-left:4px solid var(--dnas-green);padding:1.5rem;border-radius:var(--radius-lg);margin-top:2rem">
                <p style="margin:0;color:var(--text-primary)">
                    <strong><i class="fas fa-lightbulb"></i> Next Steps:</strong>
                    Learn about <a href="mcaster1dnas_stats.html" style="color:var(--mcaster-blue);font-weight:600">Server Statistics</a>
                    or explore <a href="mcaster1dnas_listenerauth.html" style="color:var(--mcaster-blue);font-weight:600">Listener Authentication</a>.
                </p>
            </div>
        </div>
    </div>
</body>
</html>
