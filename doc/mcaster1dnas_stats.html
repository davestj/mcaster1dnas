<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Statistics - Mcaster1DNAS Documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
    <style>
        :root{--mcaster-blue:#0ea5e9;--dnas-green:#22c55e;--text-primary:#1f2937;--text-secondary:#6b7280;--bg-white:#fff;--bg-light:#f8fafc;--bg-accent:#f1f5f9;--border-light:#e2e8f0;--shadow-medium:0 4px 6px -1px rgb(0 0 0 / 0.1);--gradient-brand:linear-gradient(135deg, var(--mcaster-blue), var(--dnas-green));--radius-md:0.5rem;--radius-lg:0.75rem;--font-sans:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;--font-mono:'SF Mono', 'Monaco', 'Menlo', 'Ubuntu Mono', monospace}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:var(--font-sans);line-height:1.6;color:var(--text-primary);background:var(--bg-light)}
        .breadcrumb{background:var(--bg-white);padding:1rem 0;border-bottom:1px solid var(--border-light)}
        .breadcrumb-container{max-width:1200px;margin:0 auto;padding:0 1rem;display:flex;align-items:center;gap:0.5rem;color:var(--text-secondary);font-size:0.875rem}
        .breadcrumb a{color:var(--mcaster-blue);text-decoration:none}
        .hero{background:var(--gradient-brand);color:white;padding:4rem 0 2rem 0}
        .hero-content{max-width:1200px;margin:0 auto;padding:0 1rem}
        .hero h1{font-size:3rem;font-weight:800;margin-bottom:0.5rem}
        .hero p{font-size:1.25rem;opacity:0.95}
        .container{max-width:1200px;margin:0 auto;padding:3rem 1rem}
        .content-card{background:var(--bg-white);border-radius:var(--radius-lg);padding:3rem;box-shadow:var(--shadow-medium);margin-bottom:2rem}
        .content-card h2{font-size:2rem;font-weight:700;color:var(--text-primary);margin:2.5rem 0 1rem 0;display:flex;align-items:center;gap:0.75rem}
        .content-card h2:first-child{margin-top:0}
        .content-card h2 i{color:var(--mcaster-blue)}
        .content-card h3{font-size:1.5rem;font-weight:600;color:var(--text-primary);margin:2rem 0 1rem 0}
        .content-card p{font-size:1.125rem;color:var(--text-secondary);line-height:1.8;margin-bottom:1.5rem}
        .stat-item{background:var(--bg-light);border-left:4px solid var(--mcaster-blue);padding:1.5rem;border-radius:var(--radius-lg);margin-bottom:1rem}
        .stat-item h4{font-size:1.125rem;font-weight:600;color:var(--text-primary);margin-bottom:0.5rem;font-family:var(--font-mono)}
        .stat-item p{margin:0;font-size:1rem}
        .code-block{background:#1e293b;color:#e2e8f0;padding:1.5rem;border-radius:var(--radius-md);overflow-x:auto;margin:1.5rem 0;font-family:var(--font-mono);font-size:0.875rem;line-height:1.6}
        @media (max-width:768px){.hero h1{font-size:2rem}.content-card{padding:2rem 1.5rem}}
    </style>
</head>
<body>
    <div class="breadcrumb">
        <div class="breadcrumb-container">
            <a href="index.html"><i class="fas fa-home"></i> Documentation</a>
            <i class="fas fa-chevron-right"></i>
            <span>Server Statistics</span>
        </div>
    </div>

    <div class="hero">
        <div class="hero-content">
            <h1><i class="fas fa-chart-line"></i> Server Statistics</h1>
            <p>Understanding server statistics and monitoring</p>
        </div>
    </div>

    <div class="container">
        <div class="content-card">
            <h2><i class="fas fa-info-circle"></i> Overview</h2>
            <p>
                Mcaster1DNAS v2.5.1-rc1 provides comprehensive statistics through XML endpoints that can be consumed by
                web interfaces, monitoring systems, or custom applications. Statistics are available in real-time and
                include server-wide metrics and per-mountpoint details.
            </p>

            <h3>Accessing Statistics</h3>
            <div class="code-block"><pre>http://yourserver:8000/admin/stats.xml</pre></div>
            <p>Authentication required: Use admin username and password from your configuration.</p>

            <h3>Example Statistics XML</h3>
            <div class="code-block"><pre>&lt;?xml version="1.0"?&gt;
&lt;icestats&gt;
  &lt;admin&gt;admin@example.com&lt;/admin&gt;
  &lt;host&gt;stream.example.com&lt;/host&gt;
  &lt;location&gt;Earth&lt;/location&gt;
  &lt;server_id&gt;Mcaster1DNAS 2.5.1-rc1&lt;/server_id&gt;
  &lt;server_start&gt;Mon, 15 Feb 2026 10:00:00 -0500&lt;/server_start&gt;
  &lt;server_start_iso8601&gt;2026-02-15T10:00:00-0500&lt;/server_start_iso8601&gt;
  &lt;client_connections&gt;1337&lt;/client_connections&gt;
  &lt;source_client_connections&gt;42&lt;/source_client_connections&gt;
  &lt;source_relay_connections&gt;5&lt;/source_relay_connections&gt;
  &lt;source_total_connections&gt;47&lt;/source_total_connections&gt;
  &lt;stats&gt;0&lt;/stats&gt;
  &lt;stats_connections&gt;156&lt;/stats_connections&gt;
  &lt;listeners&gt;128&lt;/listeners&gt;
  &lt;sources&gt;2&lt;/sources&gt;

  &lt;source mount="/stream"&gt;
    &lt;listeners&gt;95&lt;/listeners&gt;
    &lt;listener_peak&gt;150&lt;/listener_peak&gt;
    &lt;listener_connections&gt;890&lt;/listener_connections&gt;
    &lt;server_name&gt;My Radio Station&lt;/server_name&gt;
    &lt;server_description&gt;The best music 24/7&lt;/server_description&gt;
    &lt;server_url&gt;https://example.com&lt;/server_url&gt;
    &lt;server_type&gt;audio/mpeg&lt;/server_type&gt;
    &lt;stream_start&gt;Mon, 15 Feb 2026 10:30:00 -0500&lt;/stream_start&gt;
    &lt;stream_start_iso8601&gt;2026-02-15T10:30:00-0500&lt;/stream_start_iso8601&gt;
    &lt;genre&gt;Rock&lt;/genre&gt;
    &lt;bitrate&gt;128&lt;/bitrate&gt;
    &lt;audio_info&gt;ice-bitrate=128;ice-channels=2;ice-samplerate=44100&lt;/audio_info&gt;
    &lt;ice-bitrate&gt;128&lt;/ice-bitrate&gt;
    &lt;ice-channels&gt;2&lt;/ice-channels&gt;
    &lt;ice-samplerate&gt;44100&lt;/ice-samplerate&gt;
    &lt;artist&gt;Example Artist&lt;/artist&gt;
    &lt;title&gt;Example Song Title&lt;/title&gt;
    &lt;public&gt;1&lt;/public&gt;
  &lt;/source&gt;
&lt;/icestats&gt;</pre></div>

            <h2><i class="fas fa-globe"></i> Global Server Statistics</h2>
            <p>These statistics apply to the entire Mcaster1DNAS server instance.</p>

            <div class="stat-item">
                <h4>&lt;admin&gt;</h4>
                <p>Administrator email address from server configuration.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;host&gt;</h4>
                <p>Server hostname from configuration.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;location&gt;</h4>
                <p>Server geographic location from configuration.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;server_id&gt;</h4>
                <p>Mcaster1DNAS version string (e.g., "Mcaster1DNAS 2.5.1-rc1").</p>
            </div>

            <div class="stat-item">
                <h4>&lt;server_start&gt; / &lt;server_start_iso8601&gt;</h4>
                <p>Server startup timestamp in human-readable and ISO 8601 formats.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;client_connections&gt;</h4>
                <p>Cumulative count of all client connections (listeners, admin requests, file serving).</p>
            </div>

            <div class="stat-item">
                <h4>&lt;source_client_connections&gt;</h4>
                <p>Cumulative count of source client connections (encoders).</p>
            </div>

            <div class="stat-item">
                <h4>&lt;source_relay_connections&gt;</h4>
                <p>Cumulative count of relay connections (slave servers connecting to this master).</p>
            </div>

            <div class="stat-item">
                <h4>&lt;listeners&gt;</h4>
                <p>Current number of connected listeners across all mountpoints.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;sources&gt;</h4>
                <p>Current number of active mountpoints (connected sources).</p>
            </div>

            <h2><i class="fas fa-mountain"></i> Mountpoint-Specific Statistics</h2>
            <p>Each active mountpoint has its own statistics block within the XML.</p>

            <div class="stat-item">
                <h4>&lt;mount&gt;</h4>
                <p>The mountpoint path (e.g., "/stream", "/live.ogg").</p>
            </div>

            <div class="stat-item">
                <h4>&lt;listeners&gt;</h4>
                <p>Current number of listeners connected to this mountpoint.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;listener_peak&gt;</h4>
                <p>Peak concurrent listener count since source connection.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;listener_connections&gt;</h4>
                <p>Cumulative total of listener connections to this mountpoint.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;server_name&gt;</h4>
                <p>Stream name/title from source client or configuration.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;server_description&gt;</h4>
                <p>Stream description from source client or configuration.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;server_url&gt;</h4>
                <p>Website URL associated with the stream.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;server_type&gt;</h4>
                <p>MIME type of the stream (e.g., "audio/mpeg", "application/ogg").</p>
            </div>

            <div class="stat-item">
                <h4>&lt;genre&gt;</h4>
                <p>Stream genre/category for directory listings.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;bitrate&gt;</h4>
                <p>Stream bitrate in kbps (e.g., 128, 192, 320).</p>
            </div>

            <div class="stat-item">
                <h4>&lt;audio_info&gt;</h4>
                <p>Consolidated audio information string containing bitrate, channels, and samplerate.</p>
            </div>

            <div class="stat-item">
                <h4>&lt;ice-bitrate&gt; / &lt;ice-channels&gt; / &lt;ice-samplerate&gt;</h4>
                <p>Individual audio parameters: bitrate (kbps), channel count (1=mono, 2=stereo), sample rate (Hz).</p>
            </div>

            <div class="stat-item">
                <h4>&lt;artist&gt;</h4>
                <p>Current artist/performer from ICY-META metadata (updated by source client).</p>
            </div>

            <div class="stat-item">
                <h4>&lt;title&gt;</h4>
                <p>Current song/track title from ICY-META metadata (updated by source client).</p>
            </div>

            <div class="stat-item">
                <h4>&lt;public&gt;</h4>
                <p>YP directory listing flag (1=listed, 0=unlisted).</p>
            </div>

            <h2><i class="fas fa-code"></i> Using Statistics in Applications</h2>
            <p>Statistics can be consumed by various applications and tools:</p>

            <h3>Parse with Programming Languages</h3>
            <div class="code-block"><pre># Python example
import requests
import xml.etree.ElementTree as ET

response = requests.get('http://localhost:8000/admin/stats.xml',
                       auth=('admin', 'password'))
root = ET.fromstring(response.content)
listeners = root.find('.//listeners').text
print(f"Current listeners: {listeners}")</pre></div>

            <h3>Transform with XSLT</h3>
            <p>Mcaster1DNAS includes XSLT stylesheets in the web/ directory to transform XML into HTML pages.
            Customize these or create your own for custom interfaces.</p>

            <h3>Monitor with Scripts</h3>
            <div class="code-block"><pre>#!/bin/bash
# Simple monitoring script
LISTENERS=$(curl -s -u admin:password http://localhost:8000/admin/stats.xml | \
            grep -oP '&lt;listeners&gt;\K[^&lt;]+' | head -1)
echo "Current listeners: $LISTENERS"

if [ "$LISTENERS" -gt 100 ]; then
  echo "High load alert!" | mail -s "Listener Alert" admin@example.com
fi</pre></div>

            <h2><i class="fas fa-chart-bar"></i> Enhanced Statistics in v2.5.1-rc1</h2>
            <p>Mcaster1DNAS v2.5.1-rc1 includes additional statistics for:</p>
            <ul>
                <li><strong>YP Directory Logging:</strong> Detailed registration attempt logs and status</li>
                <li><strong>Connection Metrics:</strong> Enhanced connection tracking and performance data</li>
                <li><strong>ICY-META v2.1+:</strong> Extended metadata fields for social media integration</li>
                <li><strong>Relay Statistics:</strong> Improved relay connection and bandwidth metrics</li>
            </ul>

            <div style="background:var(--bg-accent);border-left:4px solid var(--dnas-green);padding:1.5rem;border-radius:var(--radius-lg);margin-top:2rem">
                <p style="margin:0;color:var(--text-primary)">
                    <strong><i class="fas fa-lightbulb"></i> Next Steps:</strong>
                    Explore the <a href="mcaster1dnas_admin.html" style="color:var(--mcaster-blue);font-weight:600">Admin Interface</a>
                    for web-based monitoring or learn about <a href="mcaster1dnas_relay.html" style="color:var(--mcaster-blue);font-weight:600">Relay Configuration</a>.
                </p>
            </div>
        </div>
    </div>
</body>
</html>
